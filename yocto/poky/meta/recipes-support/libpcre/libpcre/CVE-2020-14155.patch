--- pcre-8.43/pcre_compile.c    2020-07-05 22:26:25.310501521 +0530
+++ pcre-8.43/pcre_compile1.c   2020-07-05 22:30:22.254489562 +0530

CVE: CVE-2020-14155
Upstream-Status: Backport [https://vcs.pcre.org/pcre/code/trunk/pcre_compile.c?view=patch&r1=1761&r2=1760&pathrev=1761]
Signed-off-by: Rahul Taya<Rahul.Taya@kpit.com>

@@ -6,7 +6,7 @@
 and semantics are as close as possible to those of the Perl 5 language.

                        Written by Philip Hazel
-           Copyright (c) 1997-2018 University of Cambridge
+           Copyright (c) 1997-2020 University of Cambridge

 -----------------------------------------------------------------------------
 Redistribution and use in source and binary forms, with or without
@@ -7130,17 +7130,19 @@
           int n = 0;
           ptr++;
           while(IS_DIGIT(*ptr))
+           {
             n = n * 10 + *ptr++ - CHAR_0;
+            if (n > 255)
+               {
+               *errorcodeptr = ERR38;
+               goto FAILED;
+               }
+            }
           if (*ptr != CHAR_RIGHT_PARENTHESIS)
             {
             *errorcodeptr = ERR39;
             goto FAILED;
             }
-          if (n > 255)
-            {
-            *errorcodeptr = ERR38;
-            goto FAILED;
-            }
           *code++ = n;
           PUT(code, 0, (int)(ptr - cd->start_pattern + 1)); /* Pattern offset */
           PUT(code, LINK_SIZE, 0);                          /* Default length */
